Hereâ€™s the finalized code for your MITEC attendance system with:

âœ… GPS-based restriction (only at MITEC)
âœ… QR Code scanning for Employee ID
âœ… MITEC-themed UI (blue buttons, clean layout)
âœ… Google Sheets integration (via Apps Script Web App)


---

ğŸ“Œ 1. index.html (Main Page)

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITEC Attendance</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>MITEC Attendance System</h1>

    <h3>Scan Employee ID</h3>
    <div id="qr-reader" style="width: 300px;"></div>
    <input type="text" id="employeeId" placeholder="Or enter manually">

    <h3>Name</h3>
    <input type="text" id="name" placeholder="Enter your name">

    <button id="submitBtn">Submit Attendance</button>

    <script src="script.js"></script>
</body>
</html>


---

ğŸ“Œ 2. style.css (UI Styling)

body {
    font-family: Arial, sans-serif;
    text-align: center;
    background-color: #f4f4f4;
}

h1 {
    color: #003366; /* MITEC Blue */
}

input {
    padding: 10px;
    width: 80%;
    margin: 10px 0;
}

button {
    background-color: #003366;
    color: white;
    padding: 10px 20px;
    border: none;
    cursor: pointer;
}

button:hover {
    background-color: #0055a5;
}


---

ğŸ“Œ 3. script.js (QR Code, GPS, Google Sheets Integration)

document.addEventListener("DOMContentLoaded", function() {
    // QR Code Scanner
    function onScanSuccess(qrCodeMessage) {
        document.getElementById("employeeId").value = qrCodeMessage;
    }
    let qrScanner = new Html5QrcodeScanner("qr-reader", { fps: 10, qrbox: 250 });
    qrScanner.render(onScanSuccess);

    // Attendance Submission
    document.getElementById("submitBtn").addEventListener("click", function(event) {
        event.preventDefault();
        
        if (!navigator.geolocation) {
            alert("Geolocation is not supported by your browser.");
            return;
        }

        navigator.geolocation.getCurrentPosition(success, error);

        function success(position) {
            var lat = position.coords.latitude;
            var lng = position.coords.longitude;

            // MITEC Coordinates (Adjust if needed)
            var mitecLat = 3.1808;
            var mitecLng = 101.6911;
            var allowedRadius = 0.2; // 200 meters

            var distance = getDistance(lat, lng, mitecLat, mitecLng);

            if (distance <= allowedRadius) {
                submitAttendance();
            } else {
                alert("Attendance can only be submitted from MITEC.");
            }
        }

        function error() {
            alert("Unable to retrieve your location.");
        }
    });

    // Calculate Distance (Haversine Formula)
    function getDistance(lat1, lon1, lat2, lon2) {
        var R = 6371; // Earth's radius in km
        var dLat = (lat2 - lat1) * Math.PI / 180;
        var dLon = (lon2 - lon1) * Math.PI / 180;
        var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return R * c; // Distance in km
    }

    // Submit Attendance to Google Sheets
    function submitAttendance() {
        var name = document.getElementById("name").value;
        var employeeId = document.getElementById("employeeId").value;
        var location = "MITEC";

        fetch("YOUR_GOOGLE_APPS_SCRIPT_URL", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, employeeId, location })
        })
        .then(response => response.text())
        .then(data => alert("Attendance recorded!"))
        .catch(error => console.error("Error:", error));
    }
});


---

ğŸ“Œ 4. Google Apps Script (Code.gs)

To store attendance in Google Sheets, create a Google Apps Script and paste this code:

function doPost(e) {
    var sheet = SpreadsheetApp.openById("YOUR_SPREADSHEET_ID").getSheetByName("Attendance");

    var requestData = JSON.parse(e.postData.contents);
    var timestamp = new Date();

    sheet.appendRow([timestamp, requestData.name, requestData.employeeId, requestData.location]);

    return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
}

ğŸ”¹ How to Deploy:
1ï¸âƒ£ Open Google Sheets â†’ Click Extensions â†’ Apps Script.
2ï¸âƒ£ Replace YOUR_SPREADSHEET_ID with your actual Google Sheets ID.
3ï¸âƒ£ Click Deploy â†’ New Deployment â†’ Web App.
4ï¸âƒ£ Select Anyone can access (to allow submissions).
5ï¸âƒ£ Copy the Web App URL and replace "YOUR_GOOGLE_APPS_SCRIPT_URL" in script.js.


---

ğŸš€ Final Checklist

âœ… Host files on GitHub Pages (or other free hosting).
âœ… Update Google Sheets ID in Code.gs.
âœ… Replace Google Apps Script URL in script.js.
âœ… Test QR scanning and GPS restriction.


---

ğŸ“Œ Next Steps

ğŸ”¹ Do you want email notifications for submissions?
ğŸ”¹ Do you need an Admin Dashboard?
ğŸ”¹ Any UI refinements needed?

Let me know how it works! ğŸš€

